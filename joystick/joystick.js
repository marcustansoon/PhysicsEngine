var JoyStick=function(B,b){function p(){c.beginPath();c.arc(g,h,C,0,w,!1);c.lineWidth=D;c.strokeStyle=E;c.stroke()}function r(d){for(var a=0,b=0;d&&!isNaN(d.offsetLeft)&&!isNaN(d.offsetTop);)a+=d.offsetLeft-d.scrollLeft,b+=d.offsetTop-d.scrollTop,d=d.offsetParent;return{top:b,left:a}}function q(){c.beginPath();e<k&&(e=m);e+k>a.width&&(e=a.width-m);f<k&&(f=m);f+k>a.height&&(f=a.height-m);c.arc(e,f,k,0,w,!1);var d=c.createRadialGradient(g,h,5,g,h,200);d.addColorStop(0,F);d.addColorStop(1,x);c.fillStyle=
d;c.fill();c.lineWidth=G;c.strokeStyle=x;c.stroke()}var H=void 0===(b=b||{}).title?"joystick":b.title,t=void 0===b.width?0:b.width,u=void 0===b.height?0:b.height,F=void 0===b.internalFillColor?"#00AA00":b.internalFillColor,G=void 0===b.internalLineWidth?2:b.internalLineWidth,x=void 0===b.internalStrokeColor?"#003300":b.internalStrokeColor,D=void 0===b.externalLineWidth?2:b.externalLineWidth,E=void 0===b.externalStrokeColor?"#008000":b.externalStrokeColor,y=void 0===b.autoReturnToCenter||b.autoReturnToCenter,
l=document.getElementById(B),a=document.createElement("canvas");a.id=H;0==t&&(t=l.clientWidth);0==u&&(u=l.clientHeight);a.width=t;a.height=u;l.appendChild(a);var c=a.getContext("2d"),n=0,w=2*Math.PI,k=((a.height<a.width?a.height:a.width)-110)/2,m=k+5,C=k+30,g=a.width/2,h=a.height/2,z=a.width/10,I=-1*z,v=a.height/10,A=-1*v,e=g,f=h;"ontouchstart"in document.documentElement?(a.addEventListener("touchstart",function(a){n=1},!1),a.addEventListener("touchmove",function(d){d.preventDefault();1==n&&(e=d.touches[0].pageX,f=d.touches[0].pageY,
e-=a.offsetLeft+r(l).left,f-=a.offsetTop+r(l).top,c.clearRect(0,0,a.width,a.height),p(),q())},!1),a.addEventListener("touchend",function(d){n=0;y&&(e=g,f=h);c.clearRect(0,0,a.width,a.height);p();q()},!1)):(a.addEventListener("mousedown",function(a){n=1},!1),a.addEventListener("mousemove",function(d){1==n&&(e=d.pageX,f=d.pageY,e-=a.offsetLeft+r(l).left,f-=a.offsetTop+r(l).top,c.clearRect(0,0,a.width,a.height),p(),q())},!1),a.addEventListener("mouseup",function(d){n=0;y&&(e=g,f=h);c.clearRect(0,0,a.width,
a.height);p();q()},!1));p();q();this.GetWidth=function(){return a.width};this.GetHeight=function(){return a.height};this.GetPosX=function(){return e};this.GetPosY=function(){return f};this.GetX=function(){return((e-g)/m*100).toFixed()};this.GetY=function(){return((f-h)/m*-100).toFixed()};this.GetDir=function(){var a="",b=e-g,c=f-h;return c>=A&&c<=v&&(a="C"),c<A&&(a="N"),c>v&&(a="S"),b<I&&("C"==a?a="W":a+="W"),b>z&&("C"==a?a="E":a+="E"),a}};
